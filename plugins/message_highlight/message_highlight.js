var mh_cur_row;
$(document).ready(function(){window.rcmail&&($(".color").each(function(){$(this).blur(function(){mh_notsaved_warning()})}),$(".formbuttons").click(function(){parent.$(".notice").remove()}),rcmail.addEventListener("plugin.mh_receive_row",mh_receive_row),rcmail.addEventListener("insertrow",function(a){var b=rcmail.env.messages[a.row.uid];b.flags&&b.flags.plugin_mh_color&&($(a.row.obj).addClass("rcmfd_mh_row"),a.row.obj.style.backgroundColor=b.flags.plugin_mh_color)}),$(".mh_delete").on("click",function(){mh_delete(this)}),
$(".mh_add").on("click",function(){mh_add(this)}))});function mh_delete(a){confirm(rcmail.get_label("message_highlight.deleteconfirm"))&&($(a).closest("tr","#prefs-details").remove(),parent.$(".notice").remove(),document.forms.form.submit())}function mh_add(a){mh_cur_row=$(a).closest("tr","#prefs-details");lock=rcmail.set_busy(!0,"loading");rcmail.http_request("plugin.mh_add_row","",lock)}
function mh_notsaved_warning(){rcmail.display_message(rcmail.get_label("message_highlight.notsaved"),"notice")}
function mh_receive_row(a){a=a.row;$(mh_cur_row).after('<tr><td class="title">'+a+"</td><td></tr>");jscolor.init();"function"==typeof jscolor_removeHexStrings&&jscolor_removeHexStrings();mh_notsaved_warning();$(".boxcontent").click(function(){mh_notsaved_warning()});$(".boxcontent").keypress(function(){mh_notsaved_warning()});$(".color").each(function(){$(this).blur(function(){mh_notsaved_warning()})})};